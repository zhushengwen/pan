import * as cp from 'child_process'

import { promisify } from '@carnesen/util'

const execAsPromised = promisify(cp.exec, { resolveArray: true, rejectArray: true })
export async function exec (...args) {
  try {
    const [stdout, stderr] = await execAsPromised(...args)
    return { stdout, stderr }
  } catch (ex) {
    const [err, stdout, stderr] = ex
    err.stdout = stdout
    err.stderr = stderr
    throw err
  }
}
